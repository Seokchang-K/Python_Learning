# KNN (K-근접이웃)

- KNN 알고리즘이란 거리기반 분류분석 모델로 찾고자하는 target을 찾기 위해 그와 근접한 다른 이웃 feature들의 target값 들을 통해 원하던 target값을 유추 해내는 것이다.
  
  예시로 같은 비슷한 키와 몸무개를 가진 남학생들이 L 사이즈의 교복을 산다 하면 새로 교복을 사고 싶어하는 비슷한 키와 몸무게를 가진 A군 또한 L사이즈의 교복을 사면 되겠다 라는 것을 예시로 들 수 있다!

## KNN의 장점!

- 단순하고 효율적

- 훈련 단계가 빠르다

- 수치 기반 데이터 분류 작업에서 성능이 우수하다!

## KNN의 단점

- 모델을 생성하지 않기에 데이터의 특징과 각각 target값 관의 관계를 이해하는데 제한적이다.
- 적합한 K의 갯수 선택이 힘들다
- 데이터가 많아질 수록 소요 시간이 증가한다.

## KNN의 거리 측정법

KNN은 위에서 언급한 바와 같이 거리가 가까운 것에 의해 정해진다. 따라서 거리를 측정하는 방식이 중요하다!

- 종류
  
  KNN의 경우 각 feature 간의 거리를 측정하는 방식에는 유클리드 거리 측정법, 맨해튼 거리 측정법 등이 있는데 주로 사용하는 거리 측정 방식은 유클리디안 거리 측정 방법 이다.

- 유클리드 거리(Euclidean Distance)
  
  각 feature들을 2차원 평면에 좌표를 찍고 두 좌표간의 거리를 측정한다.
  
  기본적으론 피타고라스의 정리의 연속이다!
  
  ![](https://t1.daumcdn.net/cfile/tistory/99AD47485E17C4D11C)
  
  이미지 출처 : [유클리디안 거리(Euclidean Distance) 개념과 구현해보기](https://needjarvis.tistory.com/454)
  
  이처럼 점 x1,y1과 점 x2,y2 간의 거리 d를 구해 나가는 방식이 **유클리드 거리** 이다.

- 맨해튼 거리(Manhattan Distance)
  
  **맨해튼 거리**는 유클리드 거리 처럼 매우 기초적인 거리 측정 방식이다. 유클리드 거리처럼 흔히 사용되는 측정법이다.
  
  맨해튼 거리는 실제 미국의 맨해튼 처럼 사각형 모양의 건물을 지닌 길을 지나는 것처럼 유클리드의 직선으로 이동 할 수 없는 거리를 측정하기 위한 공식이다.
  
  ![](https://upload.wikimedia.org/wikipedia/commons/thumb/0/08/Manhattan_distance.svg/1024px-Manhattan_distance.svg.png)
  
  사진 출처 : [맨해튼 거리 - 위키백과, 우리 모두의 백과사전](https://ko.wikipedia.org/wiki/%EB%A7%A8%ED%95%B4%ED%8A%BC_%EA%B1%B0%EB%A6%AC)
  
  위의 그림의 초록색 선이 유클리드 거리의 측정 방식이고, 나머지 선이 맨해튼 거리 측정법의 측정 방식이다.

- 나머지 거리 측정 공식들
  
  위의 유클리드, 맨해튼 측정법 외에도 민코프스키 거리, 해밍 거리 등등 자주 사용하지 않는 거리 측정법 또한 존재한다.

## KNN 사용하기

- 먼저 데이터들을 정규화 시켜주어야 한다.
  
  서로 다른 범위를 가지는 데이터가 혼재되어 있을경우 이를 정규화 하여 비슷한 단위로 맞춰줘야 큰 단위의 값에 결과가 편향 되지 않는다.
  
  ex) 기온과 강수량의 데이터가 있다면, 기온은 단위수가 100도 이하로 나오는 2자리 수의 단위인데 반해 강수량은 800 ~ 1800mm 까지의 큰 자리수를 가진다. 따라서 이경우엔 기온보단 강수량의 데이터에 편향된 결과를 예측하게 된다.
  
  - 정규화 방법!
    
    - 최소-최대 정규화
      
      변수의 범위를 0% ~ 100% 의 범위로 정규화 시켜주는 것이다.
    
    - z-점수 표준화
      
      변수의 범위를 정규분포화 하여 평균을 0, 표준편차가 1이 되도록 하는 방법이다.

- 근접할 이웃 값인 K 를 정해줘야 한다.
  
  다만 주의 해야 할 것이 K개를 홀수로 정해주는 것이 좋다! -> 짝수 일 경우 동점 상태가 되어 target을 어떻게 분류를 정할지 애매해지기 때문이다!
  
  만약 target 값의 분류가 정확히 1 : 1 이거나 분류문제(Classification)이 아닌 회귀문제(Regression)의 경우에  target값을 어떻게 선택하느냐의 방법을 생각해야 한다.
  
  - 랜덤으로 정해서 해당 분류로 정해준다.(랜덤으로!)
  
  - Target기준으로 거리들의 합이 가장 작은 쪽을 기준으로 정한다.
  
  - 선택 확률을 이용한다!
    
    -> 선택 확률의 합을 구하고 그합이 가장 큰 쪽을 선택한다.

- 

- 이후로는 실습으로 진행한다.
